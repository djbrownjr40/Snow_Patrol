<h1 class="text-center m-4 text-primary"><strong> <%= @ski_resort.name %></strong></h1>
<div class="ski-resort-info bg-primary px-4 py-3 fixed-bottom">
  <p class="snow-report p-1 bg-success text-center">The snow right now is </p>
  <div class="map m-3" style="height: 285px">
    <div class="map-container">
      <iframe src="https://www.google.com/maps/d/u/0/embed?mid=16VPRMZK-XiRKcZk4yzphgNcfpTQ" width="100%" height="290"></iframe>
    </div>
  </div>
  <% new_checkin = current_user.check_ins.last if user_signed_in? %>
  <%# if i'm signed in and checked in in this particular resort:  %>
  <% if user_signed_in? && new_checkin&.ski_resort == @ski_resort && new_checkin&.checked_out_at == nil %>
    <%= link_to "Check out", check_in_path(new_checkin), data: {turbo_method: :patch}, class:"bby-blue-btn btn btn-secondary btn-block w-100 p-3"%>
  <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
    Write your review
  </button>
  <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#snowBackdrop">
    Snow Report
  </button>
  <%# if i'm signed in but check in in another resort: %>
  <% elsif user_signed_in? && new_checkin && new_checkin.checked_out_at == nil %>
    <%= link_to "Check out from #{new_checkin.ski_resort.name}", ski_resort_path(new_checkin.ski_resort), class:"bby-blue-btn btn btn-secondary btn-block w-100 p-3"%>
    <%# if i'm signed in but not checked in in any resort: %>
  <% elsif user_signed_in? %>
    <%= simple_form_for([@ski_resort, @check_in], remote: true) do |f|  %>
      <%= f.submit 'Check in', class: "bby-blue-btn btn btn-secondary btn-block w-100 p-3" %>
    <% end %>
    <%# if i'm not signed in yet %>
  <% else %>
    <%= link_to "Sign in", new_user_session_path, class:"bby-blue-btn btn btn-secondary btn-block w-100 p-3"%>
  <% end %>
  <div class="info text-light">
    <% if current_user&.checked_in_today?(@ski_resort) %>
      user checked in!
    <% end %>
    <div class="caracteristiques d-flex justify-content-around">
      <div class="d-flex flex-column">
        <p class="mb-1 mt-2">Length</p>
        <p><strong><%= @ski_resort.length.round(2)%>km</strong></p>
      </div>
      <div class="d-flex flex-column">
        <p class="mb-1 mt-2">Height</p>
        <p><strong><%= @ski_resort.height.round(2)%>m</strong></p>
      </div>
      <div class="d-flex flex-column">
        <p class="mb-1 mt-2">Temp</p>
        <p><strong><%= @ski_resort.temp.round(1)%>ยบ</strong></p>
      </div>
    </div>
    <div class="available-features">
      <ul class="list-unstyled">
        <% @ski_resort.features.each do |feature, available| %>
          <li>
            <%= feature.to_s.capitalize.gsub("_", " ") %>
            <% if available %>
              <i class="fa-solid fa-circle-check" style="color: #4dc567;"></i>
            <% end %>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</div>
<%= render 'review_modal' %>
<%= render 'snow_report_modal' %>
